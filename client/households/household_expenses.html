<template name="household_expense_row_header">
  <tr>
    <td>Creator</td>
    <td>Total Cost</td>
    <td>Description</td>
    {{#each object portions}}
      <td>
        {{user_email key}}
      </td>
    {{/each}}
    <td></td>
  </tr>
</template>

<template name="household_expense_row">
  {{> household_expense_row_header}}
  <tr>
    <td>{{user_email user_id}}</td>
    <td>{{cost}}</td>
    <td>{{description}}</td>
    {{#each object portions}}
      <td>
        {{value}}
      </td>
    {{/each}}
    <td>
      {{#if can "update" "expense" this}}
        <button class="edit btn btn-sm btn-warning">Edit</button>
        <button class="delete btn btn-sm btn-danger">Delete</button>
      {{/if}}
    </td>
  </tr>
</template>

<template name="household_expenses">
  {{> household_add_expense}}

  <hr/>

  <form> {{!this form is for editing.  Needs to be out here to get the household scope.}}
    <table class="table table-striped table-bordered table-condensed">
      {{#each expenses}}
        {{#if editing}}
          {{> household_expense_edit_row}}
        {{else}}
          {{> household_expense_row}}
        {{/if}}
      {{/each}}

      <tr><td colspan="100">Total expenses:</td></tr>

      <tr>
        {{#each object totalExpenses}}
          <td>
            {{user_email key}}
          </td>
        {{/each}}
      </tr>
      <tr>
        {{#each object totalExpenses}}
          <td>
            {{value}}
          </td>
        {{/each}}
      </tr>
    </table>
  </form>
</template>

<template name="household_add_expense">
  <h3>Add Expense</h3>
  <form>
    {{#if error}}
      {{error}}
    {{/if}}
    <table>
      {{#with new_expense}}
      {{> household_expense_row_header}}
      {{> household_expense_form_row}}
      {{/with}}
    </table>
<!--     <input type="submit" value="Save expense" /> -->
  </form>
</template>

<template name="household_expense_edit_row">
  {{! this should be merged with the create form... }}
  <input class="hidden" type="number" name="created_at" value="{{created_at}}" />
  {{#if error}}
    <tr><td colspan="100">{{error}}</td></tr>
  {{/if}}
  {{> household_expense_row_header}}
  {{> household_expense_form_row}}
</template>

<template name="household_expense_form_row">
  <tr>
    <td>{{user_email user_id}}</td>
    <td><input type="number" name="cost" placeholder="0.00" value="{{cost}}" /></td>
    <td><input name="description" value="{{description}}" placeholder="No description"/></td>
    {{#each object portions}}
      <td>
        <input type="number" name="portions.{{key}}" value="{{value}}" placeholder="0.00" />
      </td>
    {{/each}}
    <td>
      <button class="save btn btn-sm btn-success">Save</button>
      <!-- @Sashko: What does Cancel do? -->
     <!--  <button class="cancel">Cancel</button> -->
    </td>
  </tr>
</template>
